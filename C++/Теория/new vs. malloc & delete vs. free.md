---
metatable: false
title: new vs. malloc & delete vs. free
tags:
dateCreated: 7-го августа 2022
dateModified: 10-го августа 2022
---
# new vs. malloc & delete vs. free

* `new` —  оператор C++;
* `malloc` — функция С, которая может использоваться в С++.

Общая черта: и `new`, и `malloc` **выделяют динамическую память в куче.**

Отличительные черты: `malloc` **как аргумент принимает количество байт памяти, которую нужно выделить, и НЕ вызывает конструктор создаваемого объекта.**

* `delete` — оператор C++;
* `free` — функция C, которая может использоваться в C++.

Общая черта: и `delete`, и `free` **освобождают ранее выделенную динамическую память в куче.**

Отличительные черты: `free` **НЕ вызывает деструктор уничтожаемого объекта.**

Код ниже демонстрирует разницу между вышеописанными функциями/операторами.

```cpp
#include <iostream>

class A {  
public:  
    A() {  
        std::cout << "Ctor" << std::endl;  
    }  
    ~A() {  
        std::cout << "Dtor" << std::endl;  
    }  
};  
  
int main() {  
    auto [a1, a2] = std::make_pair(new A, (A*)malloc(sizeof(A)));  
    delete a1;  
    free(a2);  
      
    return EXIT_SUCCESS;  
}
```

Выведет в консоль:

```
Ctor
Dtor
```

```ad-tip
title: Ремарка
Выделенную память при помощи оператора `new` можно освободить при помощи функции `free`, равно как и выделенную память при помощи функции `malloc` можно освободить используя `delete`.
```